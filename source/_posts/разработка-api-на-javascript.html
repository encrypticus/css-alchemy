---
title: Разработка API на javascript
date: 2020-04-14 21:33:17
tags:
- api
- javascript
- разработка
categories:
- javascript
- разработка
- api
thumbnail: /css-alchemy/thumbnails/hamburgers.jpg
---
<p class="post__text">
  FRONTENDER MAGAZINE
  Разрабатываем более качественные API на JavaScript
  Рано или поздно вы обнаружите, что пишете на JavaScript код, который гораздо сложнее пары строчек очередного плагина под jQuery. Ваш код будет делать огромное количество вещей и с ним будут работать (в идеале) множество людей, с разными подходами к его использованию. У них будут различные уровни потребностей, знаний и ожиданий.

  Время, потраченное на создание и на использование

  Эта статья описывает наиболее важные аспекты, которые вам следует иметь в виду до и во время написания собственных утилит и библиотек. Мы постараемся обратить ваше внимание на то, каким образом вы можете сделать код более доступным для восприятия другими разработчиками. Для освещения некоторых тем, я в качестве примера буду приводить jQuery, однако эта статья совсем не об этой библиотеке, и уж точно не о том, как написать очередной плагин для неё.

  Питер Друкер однажды выразился так: «Компьютер — идиот». Так вот, не пишите код для идиотов, пишите в первую очередь для людей! Давайте же окунёмся с головой в разработку таких API, которые были бы понятны и удобны вашим коллегам.

  Текучий интерфейс
  Текучим интерфейсом (от англ. fluent interface, прим. ред.) часто называют цепочку методов, хотя это всего лишь половина правды. В глазах новичков он выглядит как стиль jQuery. Хоть я и уверен, что именно стиль API стал ключевым фактором успеха jQuery, в нём нет ничего инновационного. Лавры создателя текучего интерфейса принадлежат Мартину Фаулеру, который и придумал этот термин ещё в 2005, примерно за год до релиза jQuery. Но, с другой стороны, Фаулер лишь дал этому понятию название, сами по себе текучие интерфейсы уже использовались гораздо раньше.

  Кроме значительных упрощений, jQuery позволил сгладить серьёзные различия между браузерами. Но именно текучий интерфейс в этой крайне успешной библиотеке мне понравился больше всего. Я настолько наслаждался его использованием, что мне захотелось внедрить такой же стиль в API URI.js, разработкой которой я занимался в то время. Во время тонкой настройки API URI.js я постоянно просматривал исходники jQuery в поисках маленьких трюков, которые позволили бы сделать мою реализацию настолько простой, насколько это возможно. Оказалось, что я не один работал в этом направлении. Леа Веру создала chainvas, небольшую утилиту для оборачивания обычных API с гетерами и сеттерами в приятные текучие интерфейсы. Для Underscore что-то похожее реализовано через _.chain(). В сущности, большинство библиотек нового поколения поддерживают цепочки методов.

  Цепочки методов
  Главная идея внедрения цепочки методов в том, чтобы код как можно более легко читался и воспринимался на лету. Используя цепочки методов, можно сделать код похожим на обычные предложения, упростить его восприятие и, параллельно, избавиться от лишнего информационного шума:

  // обычные вызовы в API
  // для смены парочки цветов и добавления обработчика события
  var elem = document.getElementById("foobar");
  elem.style.background = "red";
  elem.style.color = "green";
  elem.addEventListener('click', function(event) {
  alert("hello world!");
  }, true);

  // пример реализации API с цепочкой методов
  DOMHelper.getElementById('foobar')
  .setStyle("background", "red")
  .setStyle("color", "green")
  .addEvent("click", function(event) {
  alert("hello world");
  });
  Обратите внимание на то, что мы избавились от хранения ссылки на элемент в переменной, как и от последующего повтора этой ссылки снова и снова по коду.
</p>
